(()=>{"use strict";var t,e={2371:(t,e,o)=>{const r=window.wp.i18n,n=window.wp.apiFetch;var i=o.n(n);const a={modal:null,init(){this.modal||(this.appendElementsToDom(),this.bindEvents())},appendElementsToDom(){if(document.getElementById("ccvtr-modal"))return;const t=document.createElement("div");t.id="ccvtr-modal",t.classList.add("ccvtr-modal-overlay"),t.innerHTML=`\n\t\t\t<div class="ccvtr-modal-content">\n\t\t\t\t<div class="ccvtr-modal-content-body">\n\t\t\t\t\t<h4 class="ccvtr-modal-title">\n\t\t\t\t\t\t\x3c!-- Title will be set dynamically --\x3e\n\t\t\t\t\t</h4>\n\t\t\t\t\t<p>\n\t\t\t\t\t\t${(0,r.__)("Share your email address below and we’ll let you know anytime new comments or replies are posted.","comment-notifications")}\n\t\t\t\t\t</p>\n\t\t\t\t\t<form id="ccvtr-modal-form" class="ccvtr-modal-form">\n\t\t\t\t\t\t<div class="ccvtr-input-wrapper">\n\t\t\t\t\t\t\t<label for="ccvtr-modal-name">${(0,r.__)("Your Name","comment-notifications")}:</label>\n\t\t\t\t\t\t\t<input type="text" name="name" id="ccvtr-modal-name" required />\n\t\t\t\t\t\t\t<div class="ccvtr-error-message">\n\t\t\t\t\t\t\t\t${(0,r.__)("The name field is required.","comment-notifications")}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="ccvtr-input-wrapper">\n\t\t\t\t\t\t\t<label for="ccvtr-modal-email">${(0,r.__)("Your Email Address","comment-notifications")}:</label>\n\t\t\t\t\t\t\t<input type="email" name="email" id="ccvtr-modal-email" required />\n\t\t\t\t\t\t\t<div class="ccvtr-error-message">\n\t\t\t\t\t\t\t\t${(0,r.__)("A valid email is required.","comment-notifications")}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</form>\n\t\t\t\t</div>\n\t\t\t\t<div class="ccvtr-modal-action-buttons">\n\t\t\t\t\t<button id="save-button">${(0,r.__)("Save","comment-notifications")}</button>\n\t\t\t\t\t<button id="cancel-button">${(0,r.__)("Cancel","comment-notifications")}</button>\n\t\t\t\t</div>\n\t\t\t\t<div class="ccvtr-modal-error-message"></div>\n\t\t\t</div>\n\t\t`,this.modal=document.body.appendChild(t),this.modalError=this.modal.querySelector(".ccvtr-modal-error-message"),this.saveButton=this.modal.querySelector("#save-button"),this.cancelButton=this.modal.querySelector("#cancel-button"),this.form=this.modal.querySelector("#ccvtr-modal-form"),this.formFields={name:this.form.querySelector("#ccvtr-modal-name"),email:this.form.querySelector("#ccvtr-modal-email")}},openModal(){this.modal.style.display="flex"},closeModal(){this.modal.style.display="none"},resetForm(t,e){this.form.reset(),this.form.querySelectorAll(".ccvtr-input-wrapper").forEach((t=>t.classList.remove("ccvtr-invalid-input"))),this.modalError.innerHTML="",t&&(this.formFields.email.value=t),e&&(this.formFields.name.value=e)},bindEvents(){this.saveButton.addEventListener("click",this.handleSave.bind(this)),this.cancelButton.addEventListener("click",this.closeModal.bind(this))},async handleSave(){if(this.checkForError(this.formFields.name),this.checkForError(this.formFields.email),this.form.checkValidity()){try{this.modalError.innerHTML="",this.saveButton.disabled=!0,await function(t){const{path:e,method:o,body:r,useBody:n=!1,...a}=t,s={};return n?s.body=r:s.data=r,i()({path:`ccvtr/${e}`,method:o||"GET",...a,...s})}({path:"v1/follows",method:"POST",body:{name:this.formFields.name.value,email:this.formFields.email.value,post_id:this.form.dataset.postId,nonce:this.form.dataset.nonce}})}catch(t){return this.saveButton.disabled=!1,void(this.modalError.innerHTML=(t=>t&&"string"==typeof t?t:t?.message?t.message:t?.error?t.error:(0,r.__)("An error occurred.","comment-notifications"))(t))}this.closeModal()}},checkForError(t){const e=t.closest(".ccvtr-input-wrapper");t.checkValidity()?e.classList.remove("ccvtr-invalid-input"):e.classList.add("ccvtr-invalid-input")},display(t,e,o,n,i){this.init(),
// translators: {TITLE} will be replaced with the post title.
this.modal.querySelector(".ccvtr-modal-title").innerHTML=(0,r.__)("Follow Comments and Replies to ‘{TITLE}’","comment-notifications").replace("{TITLE}",(t=>{const e=document.createElement("textarea");return e.innerHTML=t,e.value})(e)),this.form.dataset.postId=t,this.form.dataset.nonce=i,this.resetForm(o,n),this.openModal()}},s=t=>{const{postId:e,postTitle:o,userEmail:r,userName:n,nonce:i}=t.target.closest(".wp-block-comment-converter-follow-by-email").dataset;e&&i&&(t.preventDefault(),t.stopPropagation(),a.display(e,o,r,n,i))},l=()=>{document.querySelectorAll(".wp-block-comment-converter-follow-by-email").forEach((t=>t.addEventListener("click",s)))};"loading"===document.readyState?document.addEventListener("DOMContentLoaded",l):l()}},o={};function r(t){var n=o[t];if(void 0!==n)return n.exports;var i=o[t]={exports:{}};return e[t](i,i.exports,r),i.exports}r.m=e,t=[],r.O=(e,o,n,i)=>{if(!o){var a=1/0;for(d=0;d<t.length;d++){for(var[o,n,i]=t[d],s=!0,l=0;l<o.length;l++)(!1&i||a>=i)&&Object.keys(r.O).every((t=>r.O[t](o[l])))?o.splice(l--,1):(s=!1,i<a&&(a=i));if(s){t.splice(d--,1);var c=n();void 0!==c&&(e=c)}}return e}i=i||0;for(var d=t.length;d>0&&t[d-1][2]>i;d--)t[d]=t[d-1];t[d]=[o,n,i]},r.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return r.d(e,{a:e}),e},r.d=(t,e)=>{for(var o in e)r.o(e,o)&&!r.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})},r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{var t={218:0,702:0};r.O.j=e=>0===t[e];var e=(e,o)=>{var n,i,[a,s,l]=o,c=0;if(a.some((e=>0!==t[e]))){for(n in s)r.o(s,n)&&(r.m[n]=s[n]);if(l)var d=l(r)}for(e&&e(o);c<a.length;c++)i=a[c],r.o(t,i)&&t[i]&&t[i][0](),t[i]=0;return r.O(d)},o=globalThis.webpackChunkcomment_converter_plugin=globalThis.webpackChunkcomment_converter_plugin||[];o.forEach(e.bind(null,0)),o.push=e.bind(null,o.push.bind(o))})();var n=r.O(void 0,[702],(()=>r(2371)));n=r.O(n)})();